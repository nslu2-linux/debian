changes to Makefile required only on OE

Index: ixp400_xscale_sw/Makefile
===================================================================
--- ixp400_xscale_sw/Makefile.orig	2006-06-21 18:48:55.000000000 +0200
+++ ixp400_xscale_sw/Makefile	2006-06-21 19:01:56.000000000 +0200
@@ -1321,11 +1321,21 @@
 
 ixp400.o : $(OBJ_DIR)/ixp400.o
 
+kmodule: $(OBJ_DIR)/ixp400.ko
+
 ifndef IX_INCLUDE_MICROCODE
-$(OBJ_DIR)/ixp400.o: $(COMPONENTS:%=$(OBJ_DIR)/ixp400_%.o) $(OSAL_MODULE)
+$(OBJ_DIR)/ixp400.ko: $(COMPONENTS:%=$(OBJ_DIR)/ixp400_%.o) $(OSAL_MODULE)
+	rm -f $(OBJ_DIR)/ixp400.c
+	touch $(OBJ_DIR)/ixp400.c
+	cp Makefile.kmod26 $(OBJ_DIR)/Makefile
+	make -C $(OBJ_DIR)
 	$(LD) $(LDFLAGS) $^ -o $@
 else
-$(OBJ_DIR)/ixp400.o: $(COMPONENTS:%=$(OBJ_DIR)/ixp400_%.o) $(NPE_PRODUCTION_HEADER_OBJ) $(OSAL_MODULE)
+$(OBJ_DIR)/ixp400.ko: $(COMPONENTS:%=$(OBJ_DIR)/ixp400_%.o) $(NPE_PRODUCTION_HEADER_OBJ) $(OSAL_MODULE)
+	rm -f $(OBJ_DIR)/ixp400.c
+	touch $(OBJ_DIR)/ixp400.c
+	cp Makefile.kmod26 $(OBJ_DIR)/Makefile
+	make -C $(OBJ_DIR)
 	$(LD) $(LDFLAGS) $^ -o $@
 endif
 
Index: ixp400_xscale_sw/ixp400.c
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ ixp400_xscale_sw/ixp400.c	2006-06-21 18:48:56.000000000 +0200
@@ -0,0 +1 @@
+#error this file must never be compiled
Index: ixp400_xscale_sw/Makefile.kmod26
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ ixp400_xscale_sw/Makefile.kmod26	2006-06-21 18:48:56.000000000 +0200
@@ -0,0 +1,11 @@
+obj-m := ixp400.o
+
+PWD         := $(shell pwd)
+
+LINUX_SRC := $($(IX_TARGET)_KERNEL_DIR)
+
+default:
+	$(MAKE) ARCH=arm CROSS_COMPILE=$(LINUX_CROSS_COMPILE) $(KERNEL_VERBOSE) -C $(LINUX_SRC) SUBDIRS=$(PWD) modules
+
+clean:
+	rm -f ixp400.ko
